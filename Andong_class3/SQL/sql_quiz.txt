Q) MOVIES 테이블
    1. 장르별로 영화 편수를 알려주세요.
    
    2. 러닝 타임 130 이상인 영화를 제목은?

    3. 2015전과 2015후 영화는 몇 편인가?
       <--2014  2015--> 

     4. 평균 러닝 타임은 얼마인가?

     5. 가장 긴 영화와 가장 러닝 타임이 짧은
        영화의 각각의 제목은?


SELECT * FROM MOVIES;
SELECT * FROM ACTORS;
SELECT * FROM MOVIE_ACTORS;

--1번
SELECT GENRE, COUNT(*) 
FROM MOVIES
GROUP BY GENRE
ORDER BY COUNT(*) DESC;
--2번
SELECT TITLE FROM MOVIES
WHERE RUNTIME > 130
ORDER BY RUNTIME;
--4번
SELECT AVG(RUNTIME) FROM MOVIES;

--
SELECT
      SUM(CASE
              WHEN RELEASE_DATE <= TO_DATE('2014-12-31', 'YYYY-MM-DD') THEN 1 ELSE 0
          END) AS "2014이전",
      SUM(CASE
              WHEN RELEASE_DATE > TO_DATE('2014-12-31', 'YYYY-MM-DD') THEN 1 ELSE 0
          END) AS "2015이후"
FROM MOVIES;
--SUB QUERY
DESC MOVIES;

SELECT MIN(RUNTIME) FROM MOVIES; -- 112분

SELECT TITLE, RUNTIME FROM MOVIES
WHERE RUNTIME = 112;

SELECT TITLE, RUNTIME FROM MOVIES
WHERE RUNTIME = (SELECT MIN(RUNTIME) FROM MOVIES);
